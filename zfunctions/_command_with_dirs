#compdef -command-

# Show directories and files when the command position contains a slash,
# while keeping normal command completion otherwise.
setopt localoptions glob extendedglob null_glob
local ret=1

if [[ $PREFIX = */* ]]; then
  _alternative \
    'directories:directory:_path_files -/' \
    'files:file:_path_files -g "*(-.)"' && ret=0
else
  _wanted directories expl directory _files -/ -g "${PREFIX}*(/)" && ret=0
  _wanted files expl file _files -g "${PREFIX}*(-.)" && ret=0
  (( ret )) && _command_names && ret=0
fi

return ret
